@using System.IO
@model TAMHR.ESS.Infrastructure.ViewModels.RequestHistoryViewModel
@inject AclHelper AclHelper
@inject TAMHR.ESS.Infrastructure.DomainServices.TerminationService terminationServices;
@inject TAMHR.ESS.Infrastructure.Web.Runtime.Providers.PathProvider PathProvider
@{
    bool canTerminate = terminationServices.GetTerminationUserRoleKey(User.GetClaim("NoReg"));
    var formKey = Model.FormKey;
    ScriptManager.RegisterReferences("listview", "grid");
    Layout = "~/Views/Shared/_Layout.cshtml";
    var approverLevel = terminationServices.GetCurrentLevel(User.GetClaim("NoReg"), Model.FormKey, new Guid());
}
<script type="text/javascript">
    function replaceString(value) {
        return value.replace("for", "");
    }
</script>
@section pageToolbars {
    @*<ul class="page-toolbars">
            <li>
                <a class="btn btn-sm red" href="~/core/form/create?formKey=@formKey">
                    <i class="fa fa-plus-square"></i> <span class="d-none d-md-inline">@Localizer["Create New Request"]</span><span class="d-inline d-md-none">@Localizer["New"]</span>
                </a>
            </li>
        </ul>*@
    <div class="dropdown">
        <a href="javascript:;" class="btn btn-sm dropdown-toggle red-sunglo" data-toggle="dropdown">
            <i class="ft-settings"></i> <span class="d-none d-sm-inline">@Localizer["Actions"]</span> <i class="ft-chevron-down"></i>
        </a>
        <ul class="dropdown-menu dropdown-menu-right">
            <li>
                <a href="~/others/termination/viewform?formKey=@formKey&type=resignation&mode=create">
                    @Localizer["Create New Resignation Request"]
                </a>
            </li>
            @{
                if (canTerminate)
                {
                    <li>
                        <a href="~/others/termination/viewform?formKey=@formKey&type=termination&mode=create">
                            @Localizer["Create New Termination Request"]
                        </a>
                    </li>
                    @*<li>
                        <a href="javascript:;" data-target="grid" data-trigger="modal" data-modal="role-modal" data-modal-title="Update Exit Clearance" data-modal-ajax="true" data-ajax-url="~/others/termination/load">
                            @Localizer["Update Exit Clearance"]
                        </a>
                    </li>*@
                }
            }
        </ul>
    </div>
}
@{
    try
    {
        await Html.RenderPartialAsync($"~/Views/Shared/InfoSummary/{formKey.Replace("-", string.Empty)}Info.cshtml");
    }
    catch
    {
    }
}
<div class="row">
    <div class="col">
        <div class="card">
            <div class="card-header bordered">
                <h3 class="card-title">@Localizer["List Pengajuan"]</h3>
                <div class="heading-elements">
                    <ul id="submission-list-filter" class="page-toolbars" data-role="filter">
                        <li>
                            <a class="font-purple-plum" data-trigger="handler" data-handler="filterHandler">
                                <i class="icon-magnifier"></i>
                            </a>
                            <input type="text" class="search-input hidden" data-trigger="filter" data-operator="or" data-filters='["Title", "FormTitle", "DocumentNumber", "DocumentStatusCode"]' />
                        </li>
                        <li class="dropdown">
                            <a href="javascript:;" class="dropdown-toggle font-green-haze" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fa fa-sort-amount-desc"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-right">
                                <li>
                                    <a href="javascript:;" data-trigger="filter" data-sort="DocumentNumber">@Localizer["Document Number"]</a>
                                </li>
                                <li>
                                    <a href="javascript:;" data-trigger="filter" data-sort="DocumentStatusCode">Status</a>
                                </li>
                                <li>
                                    <a href="javascript:;" data-trigger="filter" data-sort="CreatedOn">@Localizer["Created Date"]</a>
                                </li>
                                <li class="dropdown-divider"></li>
                                <li class="p-2">
                                    <a href="javascript:;" class="btn red" data-trigger="filter" data-clear="sort">@Localizer["Clear"]</a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href="javascript:;" class="dropdown-toggle font-medium-2 font-blue-sharp" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fa fa-filter"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-right">
                                <li>
                                    <a href="javascript:;" data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "draft" }'>@Localizer["Draft"]</a>
                                </li>
                                <li>
                                    <a href="javascript:;" data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "inprogress" }'>@Localizer["In Progress"]</a>
                                </li>
                                <li>
                                    <a href="javascript:;" data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "completed" }'>@Localizer["Completed"]</a>
                                </li>
                                <li>
                                    <a href="javascript:;" data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "rejected" }'>@Localizer["Rejected"]</a>
                                </li>
                                <li>
                                    <a href="javascript:;" data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "revised" }'>@Localizer["Revised"]</a>
                                </li>
                                <li>
                                    <a href="javascript:;" data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "cancelled" }'>@Localizer["Dropped"]</a>
                                </li>
                                <li>
                                    <a href="javascript:;" data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "expired" }'>@Localizer["Expired"]</a>
                                </li>
                                <li class="dropdown-divider"></li>
                                <li class="p-2">
                                    <a href="javascript:;" class="btn red" data-trigger="filter" data-clear="filter">@Localizer["Clear"]</a>
                                </li>
                            </ul>
                        </li>
                        @if (AclHelper.HasPermission("Core.ViewAllDocumentApprovals") && Model.ShowFormTitle)
                        {
                            <li>
                                <div class="custom-control custom-checkbox">
                                    <input id="show-all-submission-list" type="checkbox" class="custom-control-input" data-trigger="handler" data-handler="showAllRequestHandler">
                                    <label class="custom-control-label" for="show-all-submission-list">
                                        <span class="d-inline d-md-none">@Localizer["All"]</span>
                                        <span class="d-none d-md-inline">@Localizer["Show All"]</span>
                                    </label>
                                </div>
                            </li>
                        }
                    </ul>
                </div>
            </div>
            <div class="card-body p-0 no-table-header">
                @(Html.Kendo().Grid<TAMHR.ESS.Domain.DocumentApprovalView>()
                    .Name("grid-request-history")
                    .HtmlAttributes(new { data_filter = "submission-list-filter" })
                    .Columns(columns =>
                    {
                        columns.Bound(c => c.DocumentNumber).ClientTemplate(@"
                            <div class=""media"">
                                <a class=""" + (Model.ShowFormTitle ? "mt-2" : string.Empty) + @""" href=""javascript:;"" data-trigger=""modal"" data-modal=""document-approval-history-modal"" data-modal-title=""Approval Histories -  #:DocumentNumber#"" data-modal-ajax=""true"" data-ajax-url=""~/core/home/documentapprovalhistories"" data-parameters-id=""#:Id#"">
                                    <i class=""approval-icon-#:DocumentStatusCode# font-large-2""></i>
                                </a>
                                <div class=""media-body ml-2"">
                                    <a href=""" + Url.Content($"~/others/termination/view?formKey=#:FormKey#&id=#:Id#") + @""" class=""font-dark"">
                                        " + (Model.ShowFormTitle ? @"<h6 class=""mt-1 mb-0 bold font-small-3"">#:FormTitle#</h6>" : string.Empty) + @"
                                        <h6 class=""mt-0 mb-0 bold " + (Model.ShowFormTitle ? "font-small-3" : string.Empty) + @""">#:DocumentNumber#</h6>
                                        #: kendo.toString(CreatedOn, 'dd MMM yyyy - HH:mm tt') #
                                        <br/><h6 class='mt-0 mb-0' style='font-size:small; padding-top:2px'>#:replaceString(Title.substring(Title.indexOf('for'),Title.count))#</h6>
                                </a>

                            </div>

                            <div class=""btn-group pull-right mt-1 d-block d-sm-none"">
                                    <a class=""btn btn-xs #: (CreatedBy == '" + User.GetClaim("NoReg") + @"' && DocumentStatusCode != 'cancelled' && DocumentStatusCode != 'rejected' && DocumentStatusCode != 'completed' && DocumentStatusCode != 'expired') ? 'red' : 'disabled grey' #"" data-trigger=""handler"" data-handler=""postHandler"" data-parameters-id=""#:Id#"" data-parameters-action=""cancel"">
                                        <i class=""ft-trash font-normal""></i>
                                    </a>
                                    <a class=""btn btn-xs green-jungle ml-1 #: !CanDownload ? 'disabled grey' : '' #"" target=""_blank"" href=""" + Url.Content($"~/core/form/download?formKey=#:FormKey#&id=#:Id#") + @""">
                                        <i class=""ft-download font-normal""></i>
                                    </a>
                                </div>
                            </div>
                            <a href=""javascript:;"" class=""mt-1 d-block d-sm-none"" data-trigger=""modal"" data-modal-title=""Tracking Approval - #:DocumentNumber#"" data-modal-ajax=""true"" data-ajax-url=""~/core/home/trackingapproval"" data-parameters-id=""#:Id#"">
                                <div class=""clearfix mb-1"">
                                    <div class=""pull-left"">#:app.translate(DocumentStatusTitle)#</div>
                                    <div class=""pull-right"">#:Progress#%</div>
                                </div>
                                <div class=""progress"" style=""height: 4px;"">
                                    <div class=""progress-bar progress-bar-striped #: css('DocumentApproval', DocumentStatusCode) #"" role=""progressbar"" aria-valuenow=""#:Progress#"" aria-valuemin=""#:Progress#"" aria-valuemax=""#:Progress#"" style=""width:#:Progress#%;""></div>
                                </div>
                                " + (Model.ShowFormTitle ? @"<small class=""font-grey-mint""><b>" + Localizer["Requested by"].Value + @" - #:CreatorName#</b></small>" : string.Empty) + @"
                            </a>
                        ").Width("17.2rem");

                        columns.Bound(c => c.Title).HtmlAttributes(new { @class = "align-middle p-0" }).ClientTemplate(@"
                            <a href=""javascript:;"" data-trigger=""modal"" data-modal-title=""Tracking Approval - #:DocumentNumber#"" data-modal-ajax=""true"" data-ajax-url=""~/core/home/trackingapproval"" data-parameters-id=""#:Id#"">
                                <div class=""clearfix mb-1"">
                                    <div class=""pull-left d-none d-md-block"">#:app.translate(DocumentStatusTitle)#</div>
                                    <div class=""pull-right"">#:Progress#%</div>
                                </div>
                                <div class=""progress"" style=""height: 4px;"">
                                    <div class=""progress-bar progress-bar-striped #: css('DocumentApproval', DocumentStatusCode) #"" role=""progressbar"" aria-valuenow=""#:Progress#"" aria-valuemin=""#:Progress#"" aria-valuemax=""#:Progress#"" style=""width:#:Progress#%;""></div>
                                </div>
                                " + (Model.ShowFormTitle ? @"<small class=""font-grey-mint""><b>" + Localizer["Requested by"].Value + @" - #:CreatorName#</b></small>" : string.Empty) + @"
                            </a>
                        ").MinScreenWidth(576);

                        columns.Bound(c => c.Id).HtmlAttributes(new { @class = "align-middle text-center" }).ClientTemplate(
                            @"
                            <div class=""btn-group"">
                                <a class=""btn btn-xs ml-1  #:#"" target=""_blank"" href=""" + Url.Content($"~/others/termination/ViewFormMonitoringExitClearance?formKey=#:FormKey#&id=#:Id#") + @""" title=""Monitoring Exit Clearance"">"+ Localizer["Monitoring Exit Clearance"].Value + @"</a>

                                   
                                            <a class=""btn btn-xs ml-1  #: ((("+ canTerminate.ToString().ToLower() + "==true && (Title.toLowerCase().indexOf('resignation') == -1 && (CreatedBy != '" + User.GetClaim("NoReg") + "' || " + canTerminate.ToString().ToLower() + "==true) )) || CreatedBy == '" + User.GetClaim("NoReg") + @"') && DocumentStatusCode != 'cancelled' && DocumentStatusCode != 'rejected' && DocumentStatusCode != 'completed' && DocumentStatusCode != 'expired' && Progress < 15) ? 'red' : 'disabled grey' #"" data-trigger=""handler"" data-handler=""postHandler"" data-parameters-id=""#:Id#"" data-parameters-action=""cancel"" title=""Drop Request"">
                                    <i class=""ft-trash font-normal""></i>
                                </a>

                                <a class=""btn btn-xs green-jungle ml-1 #: !CanDownload ? 'disabled grey' : '' #"" target=""_blank"" href=""" + Url.Content($"~/core/form/download?formKey=#:FormKey#&id=#:Id#") + @""" title=""Download Form"">
                                    <i class=""ft-download font-normal"">  </i>
                                </a>
                            </div>
                            <div class=""dropdown d-none"">
                                <a href=""javascript:;"" class=""btn btn-xs dropdown-toggle red-sunglo mt-2"" data-toggle=""dropdown"">
                                    <i class=""ft-chevron-down""></i>
                                </a>
                                <ul class=""dropdown-menu dropdown-menu-right"">
                                    <li>
                                        <a href=""" + Url.Content($"~/core/form/view?formKey=#:FormKey#&id=#:Id#") + @""">View</a>
                                    </li>
                                    # if (DocumentStatusCode == 'completed') { #
                                    <li>
                                       <a target=""_blank"" href=""" + Url.Content($"~/core/form/download?formKey=#:FormKey#&id=#:Id#") + @""">Download Form</a>
                                    </li>
                                    # } #
                                    <li class=""dropdown-divider""></li>
                                    <li>
                                        <a href=""javascript:;"" data-trigger=""modal"" data-modal-title=""Tracking Approval - #:DocumentNumber#"" data-modal-ajax=""true"" data-ajax-url=""~/core/home/trackingapproval"" data-parameters-id=""#:Id#"">View Tracking Approval</a>
                                    </li>
                                    <li>
                                        <a href=""javascript:;"" data-trigger=""modal"" data-modal-title=""Approval Histories -  #:DocumentNumber#"" data-modal-ajax=""true"" data-ajax-url=""~/core/home/documentapprovalhistories"" data-parameters-id=""#:Id#"">View Approval Histories</a>
                                    </li>
                                    # if (DocumentStatusCode != 'cancelled' && DocumentStatusCode != 'rejected' && DocumentStatusCode != 'completed' && DocumentStatusCode != 'expired') { #
                                        <li class=""dropdown-divider""></li>
                                        <li>
                                            <a href=""javascript:;"" data-trigger=""handler"" data-handler=""postHandler"" data-parameters-id=""#:Id#"" data-parameters-action=""cancel"">Drop Request</a>
                                        </li>
# } #
                                </ul>
                            </div>
                        ").Width(347).MinScreenWidth(576);
                    })
                    .NoRecords(config => config.Template(@"<div class=""text-center py-4 px-2 text-muted small""><img src=""" + Url.Content("~/img/folder.svg") + @""" style=""width: 150px;"" /><br/>" + Localizer["No request histories found"].Value + "</div>"))
                    .Events(evt => evt.DataBinding(@<text>function() {
                        this.element.removeClass("k-grid k-widget k-display-block");
                        this.element.find("table").addClass("table w-100 mb-1");
                    }</text>))
                    .DataSource(dataSource => dataSource
                        .Ajax()
                        .Read(read => read.Url(Url.Content("~/api/task/getformstermination")).Data(@<text>function() { return { formKey: "termination",canTerminate:@canTerminate.ToString().ToLower(),  showAll: $("#show-all-submission-list").length > 0 ? $("#show-all-submission-list").is(":checked") : false } }</text>))
                        .Sort(sort => sort.Add("CreatedOn").Descending())
                        .PageSize(10)
                    )
                    .Pageable(options => {
                        options.Input(true);
                        options.Numeric(false);
                        options.AlwaysVisible(false);
                    })
                    .Deferred(true)
                )
            </div>
        </div>
    </div>
</div>

@if (approverLevel != 0)
{
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-header bordered">
                    @*<div class="custom-control custom-checkbox d-inline">
                            <input id="check-all" type="checkbox" class="custom-control-input" data-trigger="handler" data-handler="checkAllHandler" disabled="disabled">
                            <label class="custom-control-label" for="check-all"></label>
                        </div>*@
                    <h3 class="card-title">@Localizer["Termination Submission Approval"]</h3>
                    <div class="heading-elements">
                        <ul id="task-filter" class="page-toolbars" data-role="filter">
                            <li>
                                <a class="font-purple-plum" data-trigger="handler" data-handler="filterHandler">
                                    <i class="icon-magnifier"></i>
                                </a>
                                <input type="text" class="search-input hidden" data-trigger="filter" data-operator="or" data-filters='["DocumentNumber", "Title", "DocumentStatusCode"]' />
                            </li>
                            <li class="dropdown">
                                <a class="dropdown-toggle font-green-haze" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fa fa-sort-amount-desc"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-right">
                                    <li>
                                        <a data-trigger="filter" data-sort="DocumentNumber">@Localizer["Document Number"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-sort="DocumentStatusCode">@Localizer["Status"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-sort="CreatedOn">@Localizer["Date Created"]</a>
                                    </li>
                                    <li class="dropdown-divider"></li>
                                    <li class="p-2">
                                        <a class="btn red" data-trigger="filter" data-clear="sort">@Localizer["Clear"]</a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <a class="dropdown-toggle font-medium-2 font-blue-sharp" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fa fa-filter"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-right">
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "draft" }'>@Localizer["Draft"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "inprogress" }'>@Localizer["In Progress"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "completed" }'>@Localizer["Completed"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "rejected" }'>@Localizer["Rejected"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "revised" }'>@Localizer["Revised"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "cancelled" }'>@Localizer["Dropped"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "expired" }'>@Localizer["Expired"]</a>
                                    </li>
                                    <li class="dropdown-divider"></li>
                                    <li class="p-2">
                                        <a class="btn red" data-trigger="filter" data-clear="filter">@Localizer["Clear"]</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="card-body p-0 no-table-header">
                    @(Html.Kendo().Grid<TAMHR.ESS.Domain.DocumentApprovalView>()
                    .Name("taskGrid")
                    .HtmlAttributes(new { data_filter = "task-filter" })
                    .Columns(columns =>
                    {
                        //columns.Bound(c => c.Id)
                        //    .Width(35)
                        //    .HtmlAttributes(new { @class = "pr-0", style = "vertical-align: middle;" })
                        //    .ClientTemplate(
                        //        @"<div class=""custom-control custom-checkbox"">
                        //            <input type=""checkbox"" name=""ids[]"" id=""cb#:Id#"" value=""#:Id#"" class=""custom-control-input"" data-trigger=""handler"" data-handler=""checkHandler"" #:!EnableDocumentAction || !CanSubmit?'disabled=""disabled""' : ''#"">
                        //            <label class=""custom-control-label"" for=""cb#:Id#""></label>
                        //        </div>"
                        //    );

                        columns.Bound(c => c.Title).Title("Document Title").HtmlAttributes(new { @class = "pl-3 align-middle" }).ClientTemplate(@"
                            <a class=""font-dark"" href=""" + Url.Content("~/core/form/redirectto?formKey=#:FormKey#&id=#:Id#") + @""">
                                <div>
                                    #=Title#
                                    # if(!EnableDocumentAction || !CanSubmit) { #
                                    <br />
                                    <span class='font-small-1'><i>" + Localizer["You need to open the document to approve this task"].Value + @"</i></span>
                                    # } #
                                </div>
                                <div class=""progress mt-1 mb-1"" style=""height: 4px;"">
                                    <div class=""progress-bar progress-bar-striped #: css('DocumentApproval', DocumentStatusCode) #"" role=""progressbar"" aria-valuenow=""#:Progress#"" aria-valuemin=""#:Progress#"" aria-valuemax=""#:Progress#"" style=""width:#:Progress#%;""></div>
                                </div>
                                <div class='d-flex'>
                                    <span class='font-small-1'><i class='icon-clock'></i> &nbsp;#:kendo.toString(CreatedOn, 'dd MMM yyyy - HH:mm tt')#</span>
                                    <span class='font-small-1 ml-auto'>#:Progress#%</span>
                                </div>
                            </a>
                        ");
                    })
                    .NoRecords(config => config.Template(@"<div class=""text-center p-2 text-muted""><i class=""fa fa-clipboard font-large-1""></i><br/>" + Localizer["No task list found"].Value + "</div>"))
                    .Events(evt =>
                    {
                    evt.DataBinding(@<text>function() {
                            this.element.removeClass("k-grid k-widget k-display-block");
                            this.element.find("table").addClass("table w-100 mb-1");
                        }</text>);
                        evt.DataBound(@<text>function() {
                            var $checkAllEl = $("#check-all"),
                                data = this.dataSource.data(),
                                total = data.length,
                                totalCanSubmit = $.grep(data, function(obj) { return obj.CanSubmit && obj.EnableDocumentAction; }).length;

                            $checkAllEl.prop("checked", false);
                            $checkAllEl.prop("disabled", data.length === 0 || totalCanSubmit === 0);
                            $("#executeBtn").addClass("disabled");
                        }</text>);
                    })
                    .DataSource(dataSource => dataSource
                        .Ajax()
                        .Read(read => read.Url(Url.Content("~/api/task/getstermination")).Data(@<text>function() { return { formKey: "termination", showAll: $("#show-all-submission-list").length > 0 ? $("#show-all-submission-list").is(":checked") : false } }</text>))
                        .Sort(sort => sort.Add("CreatedOn").Descending())
                    )
                    .Pageable(options =>
                    {
                        options.Input(true);
                        options.Numeric(false);
                        options.AlwaysVisible(false);
                    })
                    .Deferred()
                )
                </div>
            </div>
        </div>
    </div>
}

@*<div class="row">
        <div class="col">
            <div class="card">
                <div class="card-header bordered">
                    <h3 class="card-title">@Localizer["Termination Submission Approval"]</h3>
                    <div class="heading-elements">
                        <ul id="termination-submission-approval-filter" class="page-toolbars" data-role="filter">
                            <li>
                                <a class="font-purple-plum" data-trigger="handler" data-handler="filterHandler">
                                    <i class="icon-magnifier"></i>
                                </a>
                                <input type="text" class="search-input hidden" data-trigger="filter" data-operator="or" data-filters='["DocumentNumber", "Title", "DocumentStatusCode"]' />
                            </li>
                            <li class="dropdown">
                                <a class="dropdown-toggle font-green-haze" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fa fa-sort-amount-desc"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-right">
                                    <li>
                                        <a data-trigger="filter" data-sort="DocumentNumber">@Localizer["Document Number"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-sort="DocumentStatusCode">@Localizer["Status"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-sort="CreatedOn">@Localizer["Date Created"]</a>
                                    </li>
                                    <li class="dropdown-divider"></li>
                                    <li class="p-2">
                                        <a class="btn red" data-trigger="filter" data-clear="sort">@Localizer["Clear"]</a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <a class="dropdown-toggle font-medium-2 font-blue-sharp" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fa fa-filter"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-right">
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "draft" }'>@Localizer["Draft"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "inprogress" }'>@Localizer["In Progress"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "completed" }'>@Localizer["Completed"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "rejected" }'>@Localizer["Rejected"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "revised" }'>@Localizer["Revised"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "cancelled" }'>@Localizer["Dropped"]</a>
                                    </li>
                                    <li>
                                        <a data-trigger="filter" data-filter='{ "field": "DocumentStatusCode", "value": "expired" }'>@Localizer["Expired"]</a>
                                    </li>
                                    <li class="dropdown-divider"></li>
                                    <li class="p-2">
                                        <a class="btn red" data-trigger="filter" data-clear="filter">@Localizer["Clear"]</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="card-body p-0 no-table-header">
                    @(Html.Kendo().Grid<TAMHR.ESS.Domain.DocumentApprovalView>()
                        .Name("grid-termination-submission-approval")
                        .HtmlAttributes(new { data_filter = "termination-submission-approval-filter" })
                        .Columns(columns =>
                        {
                            columns.Bound(c => c.Id).HtmlAttributes(new { @class = "pr-0 align-middle position-relative" }).ClientTemplate(@"
                                <a data-trigger=""modal"" data-modal-title=""Approval Histories -  #:DocumentNumber#"" data-modal-ajax=""true"" data-ajax-url=""~/core/home/documentapprovalhistories"" data-parameters-id=""#:Id#"">
                                    <div class=""position-relative"">
                                        <i class=""approval-icon-#:DocumentStatusCode# font-large-2""></i>
                                    </div>
                                </a>
                            ").Width(35);
                            columns.Bound(c => c.Title).Title("Document Title").HtmlAttributes(new { @class = "pl-3 align-middle" }).ClientTemplate(@"
                                <a class=""font-dark"" href=""" + Url.Content("~/core/form/view?formKey=#:FormKey#&id=#:Id#") + @""">
                                    <div>
                                        #=Title#
                                    </div>
                                </a>
                                <a data-trigger=""modal"" data-modal-title=""Tracking Approval - #:DocumentNumber#"" data-modal-ajax=""true"" data-ajax-url=""~/core/home/trackingapproval"" data-parameters-id=""#:Id#"">
                                    <div class=""progress mt-1 mb-1"" style=""height: 4px;"">
                                        <div class=""progress-bar progress-bar-striped #: css('DocumentApproval', DocumentStatusCode) #"" role=""progressbar"" aria-valuenow=""#:Progress#"" aria-valuemin=""#:Progress#"" aria-valuemax=""#:Progress#"" style=""width:#:Progress#%;""></div>
                                    </div>
                                    <div class='d-flex'>
                                        <span class='font-small-1'><i class='icon-clock'></i> &nbsp;#:kendo.toString(CreatedOn, 'dd MMM yyyy - HH:mm tt')#</span>
                                        <span class='font-small-1 ml-auto'>#:Progress#%</span>
                                    </div>
                                </a>
                                <div class=""btn-group d-block d-sm-none mt-3"">
                                    <a class=""btn btn-xs #: (CreatedBy == '" + User.GetClaim("NoReg") + @"' && DocumentStatusCode != 'cancelled' && DocumentStatusCode != 'rejected' && DocumentStatusCode != 'completed' && DocumentStatusCode != 'expired') ? 'red' : 'disabled grey' #"" data-trigger=""handler"" data-handler=""postHandler"" data-parameters-id=""#:Id#"" data-parameters-action=""cancel"">
                                        <i class=""ft-trash font-normal""></i>
                                    </a>
                                    <a class=""btn btn-xs green-jungle ml-1 #: !CanDownload ? 'disabled grey' : '' #"" target=""_blank"" href=""" + Url.Content($"~/core/form/download?formKey=#:FormKey#&id=#:Id#") + @""">
                                        <i class=""ft-download font-normal""></i>
                                    </a>
                                </div>
                            ");
                            columns.Bound(c => c.Id).HtmlAttributes(new { @class = "align-middle pl-0" }).ClientTemplate(@"
                                <div class=""btn-group"">
                                    <a class=""btn btn-xs #: (CreatedBy == '" + User.GetClaim("NoReg") + @"' && DocumentStatusCode != 'cancelled' && DocumentStatusCode != 'rejected' && DocumentStatusCode != 'completed' && DocumentStatusCode != 'expired') ? 'red' : 'disabled grey' #"" data-trigger=""handler"" data-handler=""postHandler"" data-parameters-id=""#:Id#"" data-parameters-action=""cancel"" title=""Drop Request"">
                                        <i class=""ft-trash font-normal""></i>
                                    </a>
                                    <a class=""btn btn-xs green-jungle ml-1 #: !CanDownload ? 'disabled grey' : '' #"" target=""_blank"" href=""" + Url.Content($"~/core/form/download?formKey=#:FormKey#&id=#:Id#") + @""" title=""Download Request"">
                                        <i class=""ft-download font-normal""></i>
                                    </a>
                                </div>
                                <div class=""dropdown d-none"">
                                    <a class=""btn btn-xs dropdown-toggle red-sunglo mt-2"" data-toggle=""dropdown"">
                                        <i class=""ft-chevron-down""></i>
                                    </a>
                                    <ul class=""dropdown-menu dropdown-menu-right"">
                                        <li>
                                            <a href=""" + Url.Content($"~/core/form/view?formKey=#:FormKey#&id=#:Id#") + @""">View</a>
                                        </li>
                                        # if (DocumentStatusCode == 'completed') { #
                                        <li>
                                            <a>Download Form</a>
                                        </li>
                                        # } #
                                        <li class=""dropdown-divider""></li>
                                        <li>
                                            <a data-trigger=""modal"" data-modal-title=""Tracking Approval - #:DocumentNumber#"" data-modal-ajax=""true"" data-ajax-url=""~/core/home/trackingapproval"" data-parameters-id=""#:Id#"">View Tracking Approval</a>
                                        </li>
                                        <li>
                                            <a data-trigger=""modal"" data-modal-title=""Approval Histories -  #:DocumentNumber#"" data-modal-ajax=""true"" data-ajax-url=""~/core/home/documentapprovalhistories"" data-parameters-id=""#:Id#"">View Approval Histories</a>
                                        </li>
                                    </ul>
                                </div>
                            ").Width(55).MinScreenWidth(576);
                        })
                        .NoRecords(config => config.Template(@"<div class=""text-center p-2 text-muted""><i class=""fa fa-clipboard font-large-1""></i><br/>" + Localizer["No history found"].Value + "</div>"))
                        .Events(evt => evt.DataBinding(@<text>function() {
                            this.element.removeClass("k-grid k-widget k-display-block");
                            this.element.find("table").addClass("table w-100 mb-1");
                        }</text>))
                        .DataSource(dataSource => dataSource
                            .Ajax()
                            .Read(read => read.Url(Url.Content("~/api/task/gethistoriestermination")).Data(@<text>function() { return { formKey: "termination", showAll: $("#show-all-submission-list").length > 0 ? $("#show-all-submission-list").is(":checked") : false } }</text>))
                            .Sort(sort =>
                            {
                                sort.Add("LastApprovedOn").Descending();
                                sort.Add("CreatedOn").Descending();
                            })
                        )
                        .Pageable(options =>
                        {
                            options.Input(true);
                            options.Numeric(false);
                            options.AlwaysVisible(false);
                        })
                        .Deferred(true)
                    )
                </div>
            </div>
        </div>
    </div>*@