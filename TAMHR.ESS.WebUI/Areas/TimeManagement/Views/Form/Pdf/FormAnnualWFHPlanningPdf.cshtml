@model PdfViewModel;
@inject TAMHR.ESS.Infrastructure.DomainServices.AnnualWFHPlanningService annualWFHPlanningService;
@inject TAMHR.ESS.Infrastructure.DomainServices.CoreService coreService;
@{
    Layout = null;
    AnnualWFHPlanning abp = annualWFHPlanningService.GetAnnualWFHPlanningByDocumentApprovalId(Model.DocumentApproval.Id).FirstOrDefault();
    IEnumerable<AnnualWFHPlanningSummaryPdfStoredEntity> summary = annualWFHPlanningService.GetAnnualWFHPlanningSummaryPdfData(Model.DocumentApproval.Id);
    AnnualWFHPlanningSummaryPdfStoredEntity totalWorkingDay = null;
    IEnumerable<AnnualWFHPlanningSummaryPdfStoredEntity> totalWFH = null;
    IEnumerable<AnnualWFHPlanningDetailView> details = annualWFHPlanningService.GetDetails(Model.DocumentApproval.Id).OrderBy(a => a.StartDate);
    int subordinates = annualWFHPlanningService.GetManPower(abp.Submitter).Count();

    int rowNo = 1;
    if (summary.Count() > 0)
    {
        totalWorkingDay = summary.Where(s => s.Category == "working-day").FirstOrDefault();
        totalWFH = summary.Where(s => s.Category == "wfh-summary");
    }
}

<style type="text/css">
    td {
        padding: 2px;
    }

    .border-bottom {
        border-bottom: 1px solid black
    }

    .border-top {
        border-top: 1px solid black
    }

    .border-left {
        border-left: 1px solid black
    }

    .border-right {
        border-right: 1px solid black
    }

    .border {
        border: 1px solid black
    }

    table {
        border-collapse: collapse;
    }

    .bg-gray {
        background: #efefef
    }

    .bold {
        font-weight: bold
    }

    .bg-light-blue {
        background-color: rgb(221, 235, 247);
    }

    .bg-dark-blue {
        background-color: rgb(47, 117, 181);
    }
</style>
<hr style="margin-bottom:20px" />


<table class="tableizer-table bold" style="font-family:'Segoe UI'; font-size:12px; width: 100%;" border="1" cellspacing="0" cellpadding="0">
    <tr>
        <td colspan="15" style="text-align: center;"><h2>@Localizer["WFO WFH PLANNING"]</h2></td>
    </tr>

    <tr>
        <td colspan="15" style="text-align: center;"><h3>@Localizer["Division: " + Model.OrgInfo.OrgName]</h3></td>
    </tr>

    <tr>
        <td rowspan="2" style="width: 10%"></td>
        <td colspan="14" style="text-align: center;">@(abp == null ? string.Empty : abp.YearPeriod.ToString())</td>
    </tr>

    <tr>
        <td style="width: 7%">@Localizer["Jan"]</td>
        <td style="width: 7%">@Localizer["Feb"]</td>
        <td style="width: 7%">@Localizer["Mar"]</td>
        <td style="width: 7%">@Localizer["Apr"]</td>
        <td style="width: 7%">@Localizer["May"]</td>
        <td style="width: 7%">@Localizer["Jun"]</td>
        <td style="width: 7%">@Localizer["Jul"]</td>
        <td style="width: 7%">@Localizer["Aug"]</td>
        <td style="width: 7%">@Localizer["Sep"]</td>
        <td style="width: 7%">@Localizer["Oct"]</td>
        <td style="width: 7%">@Localizer["Nov"]</td>
        <td style="width: 7%">@Localizer["Dec"]</td>
        <td style="width: 3%">@Localizer["DAY TOTAL"]</td>
        <td style="width: 3%">@Localizer["HOUR TOTAL"]</td>
    </tr>

    <tr>
        <td>@Localizer["Total MP"]</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right">@subordinates</td>
        <td style="text-align: right"></td>
        <td style="text-align: right"></td>
    </tr>

    <tr class="bg-light-blue">
        <td>@Localizer["Total Working Day"]</td>
        @if (totalWorkingDay != null)
        {
            <td style="text-align: right">@totalWorkingDay.Jan</td>
            <td style="text-align: right">@totalWorkingDay.Feb</td>
            <td style="text-align: right">@totalWorkingDay.Mar</td>
            <td style="text-align: right">@totalWorkingDay.Apr</td>
            <td style="text-align: right">@totalWorkingDay.May</td>
            <td style="text-align: right">@totalWorkingDay.Jun</td>
            <td style="text-align: right">@totalWorkingDay.Jul</td>
            <td style="text-align: right">@totalWorkingDay.Aug</td>
            <td style="text-align: right">@totalWorkingDay.Sep</td>
            <td style="text-align: right">@totalWorkingDay.Oct</td>
            <td style="text-align: right">@totalWorkingDay.Nov</td>
            <td style="text-align: right">@totalWorkingDay.Dec</td>
            <td style="text-align: right">@(totalWorkingDay.Jan + totalWorkingDay.Feb + totalWorkingDay.Mar + totalWorkingDay.Apr + totalWorkingDay.May + totalWorkingDay.Jun + totalWorkingDay.Jul + totalWorkingDay.Aug + totalWorkingDay.Sep + totalWorkingDay.Oct + totalWorkingDay.Nov + totalWorkingDay.Dec)</td>
            <td style="text-align: right">@((totalWorkingDay.Jan + totalWorkingDay.Feb + totalWorkingDay.Mar + totalWorkingDay.Apr + totalWorkingDay.May + totalWorkingDay.Jun + totalWorkingDay.Jul + totalWorkingDay.Aug + totalWorkingDay.Sep + totalWorkingDay.Oct + totalWorkingDay.Nov + totalWorkingDay.Dec) * 8)</td>
        }
        else
        {
            <td colspan="14" style="text-align: center;">@Localizer["No Data Available"]</td>
        }
    </tr>

    <tr class="bg-dark-blue">
        <td colspan="15" style="text-align: center;">@Localizer["WFO WFH PLANNING"]</td>
    </tr>

    @if (totalWFH != null && totalWFH.Count() > 0)
    {
        @foreach (AnnualWFHPlanningSummaryPdfStoredEntity WFH in totalWFH)
        {

            <tr class="bg-light-blue"><td colspan="15">@(rowNo.ToString() + ". " + WFH.Name)</td></tr>

            <tr class="bg-light-blue">
                <td>@Localizer["Total Day WFH"]</td>
                <td style="text-align: right">@WFH.Jan</td>
                <td style="text-align: right">@WFH.Feb</td>
                <td style="text-align: right">@WFH.Mar</td>
                <td style="text-align: right">@WFH.Apr</td>
                <td style="text-align: right">@WFH.May</td>
                <td style="text-align: right">@WFH.Jun</td>
                <td style="text-align: right">@WFH.Jul</td>
                <td style="text-align: right">@WFH.Aug</td>
                <td style="text-align: right">@WFH.Sep</td>
                <td style="text-align: right">@WFH.Oct</td>
                <td style="text-align: right">@WFH.Nov</td>
                <td style="text-align: right">@WFH.Dec</td>
                <td style="text-align: right">@(WFH.Jan + WFH.Feb + WFH.Mar + WFH.Apr + WFH.May + WFH.Jun + WFH.Jul + WFH.Aug + WFH.Sep + WFH.Oct + WFH.Nov + WFH.Dec)</td>
                <td style="text-align: right">@((WFH.Jan + WFH.Feb + WFH.Mar + WFH.Apr + WFH.May + WFH.Jun + WFH.Jul + WFH.Aug + WFH.Sep + WFH.Oct + WFH.Nov + WFH.Dec) * 8)</td>
                @{ rowNo = rowNo + 1; }
            </tr>

        }
    }
    else
    {
        <tr class="bg-light-blue">
            <td colspan="15">@Localizer["No WFH data available"]</td>
        </tr>
    }

</table>