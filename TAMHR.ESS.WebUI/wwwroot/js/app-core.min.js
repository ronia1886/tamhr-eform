/*!
  * App Core v1.0.0
  * Copyright 2018 by Hensem Brian
  */
(function(n,t,i,r){function st(n){if(v(n))throw`Url cannot be empty`;return y=(new i.HubConnectionBuilder).withUrl(u.resolveUrl(n)).configureLogging(i.LogLevel.Information).build()}function wt(n=""){return e(n)?e(y)?null:y:st(n)}function g(t,i){let u={},f=i!==r;return t.length&&s(t[0].attributes,function(n,t){(!f||f&&t.name.startsWith(i))&&(u[t.name.substring(f?i.length:0)]=t.value)}),n.isEmptyObject(u)?r:u}function e(t){return t===r||n.isEmptyObject(t)}function v(n){return n===null||n===""}function bt(n){if(n!=null&&n!=""){const[e,o,i]=n.split("/");let t=0,r=0;const[,u,f]=i.split(" ");if(u){const[n,i]=u.split(":");t=parseInt(n);t=t==12&&f=="AM"?0:t<12&&f=="PM"?t+12:t;r=parseInt(i)}return new Date(i.substring(0,4),o-1,e,t,r,0)}return new Date}function kt(n){if(e(n)||v(n)||/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(n))return!1;var t=n.toString().split(/[\.\-\/]/),r=parseInt((t[2]||"").substring(0,4),10),u=parseInt(t[1],10),f=parseInt(t[0],10),i=new Date(r,u-1,f,0,0,0,0);return u===i.getMonth()+1&&f===i.getDate()&&r===i.getFullYear()}function ht(n){for(var t in n)typeof n[t]=="object"?ht(n[t]):kt(n[t])&&(n[t]=kendo.toString(bt(n[t]),"yyyy-MM-dd HH:mm tt"))}function nt(t,i,r,f,o,s){return ht(r),n.ajax({type:t,contentType:s,url:u.resolveUrl(i),dataType:o,data:e(o)?r:JSON.stringify(r),success:function(n){typeof f=="function"&&f(n)}})}function o(n){return typeof n=="function"}function dt(n){return typeof n=="string"}function h(n){return c.hasOwnProperty(n)?c[n]:r}function w(n,t,i){let r=i||"";ft(n,r,t)}function gt(n){return k.hasOwnProperty(n)||(k[n]=0),++k[n]}function f(t){return t===r?r:dt(t)?n("#"+t):t.jquery?t:n(t)}function ni(n){return n!==r&&f(n).length>0}function ti(t){let i=f(t),c=i.data("modal"),p=i.data("modalIcon"),l=i.data("modalTitle")||i.data("title"),k=i.data("htmlTitle")||!1,w=i.data("modalType")||"lg",d=i.data("modalAjax")||!1,b=u.resolveUrl(i.data("ajaxUrl")||""),nt=i.data("modalCallback")||"",tt=ni(c);if(e(c)&&(c="app-modal-instance-"+gt("modal"),i.data("modal",c)),!tt){let t=`
                    <div id="${c}" class="modal fade bs-modal-${w}"  role="dialog" aria-hidden="true" style="display: none;">
                        <div class="modal-dialog modal-${w}" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">${l}</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="loader"></div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn dark btn-outline btn-modal-close" data-dismiss="modal">${u.translate("Close")}</button>
                                </div>
                            </div>
                        </div>
                    </div>`;n("body").append(t)}let s=f(c),a=h(nt),y=s.find(".modal-title");if(e(p)?k?y.html(l):y.text(l):y.html(`<i class="${p}"></i> `+l),d&&!v(b)){let n=s.find(".loader")||s.find(".modal-body"),f=i.data("ajaxParameters")||i.data("parameters")||g(i,"data-parameters-"),c=i.data("ajaxHandler")||"",t=f;if(n.html(""),u.blockUI({message:u.translate("Loading content..."),boxed:!0,showOverlay:!1,target:n}),e(t)){let n=h(c);t=o(n)?n.apply(i[0]):{}}n.load(b,t,function(n,t){if(t!=="error"){let e=s.find(".modal-footer");e.find(".actions").remove();let f=s.find(".modal-body .actions").detach();f.data("sender",i);f.length>0&&e.prepend(f);a!==r&&a.apply(s);u.unblockUI(s)}})}else if(a!==r)s.on("show.bs.modal",pt(a,s));s.modal("show")}function ii(n){let t=f(n),u=t.data("handler")||"",e=t.data("parameters")||g(t,"data-parameters-")||{},i=h(u);return o(i)?i.apply(t[0],[e]):r}function ri(n){let t=f(n.data("targetForm"))||n.closest("form"),i=n.attr("name"),e=n.val(),u=t.find("input[name='"+i+"']");return u===r||u===null||u.length===0?t.append("<input type='hidden' name='"+i+"' value ='"+e+"' />"):t.find("input[name='"+i+"']").val(e),t}function ui(t){let i=f(t),s=i.closest(".modal"),e=s.length>0?s.find("form"):ri(i),c=i.data("method")||(e.attr("method")||a.post).toLowerCase(),o=e.serializeObject(),l=i.data("url")||e.attr("action"),d=i.data("interceptor")||"",g=i.data("precallback")||"",nt=i.data("errorHandler")||"",v=i.data("callback")||"",y=h(d),p=h(g),w=h(nt),tt=i.data("confirmation"),it=i.data("draft")||!1,rt=i.data("confirmationmsg");if(i.data("submitted")!==!0){i.data("submitted",!0);o.Object!==r&&o.Object!==null&&(o.Object.IsDraft=it);var b=0,k=0;(n(".k-file")!=r||n(".k-file")!=null)&&n(".k-file").find(".k-progress").each(function(){var i=n(this),r=i.closest(".k-file"),t=r.find(".ajax-file-upload-green");!t.is(":visible")&&t.closest(".k-upload").is(":visible")&&(b+=1)});n(".k-file").find(".ajax-file-upload-error").length>0&&(k+=1);b>0?k>0?u.warning("Uploading file error."):u.warning("Uploading file still on progress."):tt===!0?u.confirm(rt,function(n){if(!n.value){i.data("submitted",!1);i.data("confirm",!1);return}i.data("confirm")!==!0&&(i.data("confirm",!0),ct(i,s,e,c,o,l,v,p,t,y,w))}):ct(i,s,e,c,o,l,v,p,t,y,w)}}function ct(t,i,f,e,s,c,l,a,v,y,p){var b=t.data("parameters")||g(t,"data-parameters-")||{},w;if(t.prop("disabled",!0),o(y)&&(s=y.apply(v,[s])),o(a)&&a.apply(v,[b])!==!0)t.prop("disabled",!1),t.data("confirm",!1),t.data("submitted",!1);else{if(w=n[e],!o(w))return;w(c,s,function(n){let t=h(l);t!==r?t.apply(v,[n,b]):u.warning("Warning","Callback must be defined")}).fail(function(n){var t=n.responseJSON.errors||{};n.responseText.includes("Request Rejected")&&u.error(n.responseText);o(p)?p.apply(v,[f,t]):vt(f,t)||f.validate(t)}).always(function(){t.prop("disabled",!1);t.data("confirm",!1);t.data("submitted",!1)})}}function lt(t,i){return e(t)?t:n.extend({},t,i||{})}function at(t,i){if(typeof t=="undefined")return{};if(n.isPlainObject(t))return t;let r={};return r[i]=t,r}function fi(t){let r=f(t),u=r.closest("[data-role='filter']"),a=r.closest("li"),c=r.closest("ul"),o=r.data("clear")||"",h=lt(at(r.data("sort"),"field"),{dir:"asc"}),l=lt({operator:"eq"},at(r.data("filter"),"field")),i=u.data("query")||{};i.sort=e(h)?o=="sort"?{}:i.sort:h;i.filter=e(l)?o=="filter"?{}:i.filter:l;c.find("li").removeClass("active");v(o)&&a.removeClass("active").addClass("active");let y=n("[data-filter='"+u.attr("id")+"']");s(y,(t,r)=>{let f=n(r),u=f.data(d[f.data("role")]).dataSource;!e(i.sort)&&!e(u._sort)&&u._sort.length>0&&u._sort[0].field==i.sort.field&&(i.sort.dir=u._sort[0].dir=="asc"?"desc":"asc");let o=n.extend({},i,{page:u.options.page,pageSize:u.options.pageSize});u.query(o)});c.find("i.float-right").remove();e(h)||(i.sort.dir=="asc"?r.append("<i class='ft-arrow-up float-right font-red-sunglo' style='font-size: 0.76rem; margin-top: 0.25rem;'><\/i>"):r.append("<i class='ft-arrow-down float-right font-red-sunglo' style='font-size: 0.76rem; margin-top: 0.25rem;'><\/i>"));u.data("query",i)}function vt(n,t){return t.hasOwnProperty("Exception")?(n.find("[role='alert']").removeClass("hidden").show(),n.find(".alert-title").text(t.Title),n.find(".alert-message").text(t.Message),!0):!1}function ei(n,t){switch(n){case"modal":ti(t);break;case"handler":ii(t);break;case"submit":ui(t);break;case"filter":fi(t)}}function oi(t){let i=f(t),u=i.data("operator")||"or",e=i.data("filters"),o=i.closest("[data-role='filter']"),r=[],h=n("[data-filter='"+o.attr("id")+"']");s(e,function(n,t){let f=typeof t=="string"?t:t.field,e=t.operator||"contains",u=i.val();u!=""&&u!=null&&r.push({field:f,operator:e,value:u})});s(h,function(t,i){let f=n(i),e=f.data(d[f.data("role")]).dataSource;e.filter({logic:u,filters:r})})}function si(i){var s;let f=i.closest("form"),e=i.files[0],c=e.name,o=i.name,l=n("input[type='text'][name='"+i.name+"']"),h=n(i).closest(".form-group");s=new FormData;s.append(e.name,e);h.find(".progress").remove();var a=h.append('<div class="progress" style="height: 4px;"><div class="progress-bar progress-bar-striped bg-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="0" style="width:0%;"><\/div><\/div>'),v=a.find(".progress-bar"),y=n.ajax({url:it,type:"POST",contentType:!1,processData:!1,data:s,cache:!1,async:!0,xhr:function(){var n=new t.XMLHttpRequest;return n.upload.addEventListener("progress",function(n){if(n.lengthComputable){var t=Math.round(n.loaded/n.total*100);v.css("width",t+"%")}},!1),n}}).done(function(t){(t.files!==r||t.files!==null)&&n.each(t.files,function(t,i){i.Id!==null?(n(".common-file-"+o).remove(),n(f).append("<div class='common-file-"+o+"' data-id='"+i.Id+"' data-filename='"+i.FileName+"'>"),n(f).append("<input type='hidden' name='Attachments[][CommonFileId]' value ='"+i.Id+"'>"),n(f).append("<input type='hidden' name='Attachments[][FieldCategory]' value ='"+o+"'>"),n(f).append("<input type='hidden' name='Attachments[][FileName]' value ='"+i.FileName+"'>"),n(f).append("<\/div>"),l.val(c)):w(p.error,"Failed to upload attachment, please try again.","Upload Failed")})}).fail(function(n,t,i){i==="abort"?u.error("Uploading was aborted"):u.error("Uploading failed")}).always(function(){})}function hi(t,i){var c=t[0].nodeName.toLowerCase(),f;if(c==="form"){if(f=null,t.find("span.invalid[data-validation-for]").text(""),s(t.find("[data-validation-for]"),function(r,u){var e=n(u),s=e.data("validationFor"),o=t.find("[name='"+s+"']"),h=o.parent().closest(".form-control"),c=n.inArray(e[0].nodeName.toLowerCase(),["input","select","textarea"])!==-1,l;(h.removeClass("is-invalid"),o.removeClass("is-invalid"),i.hasOwnProperty(s))&&(f==null&&(f=o),l=i[s],h.hasClass("is-invalid")||h.addClass("is-invalid"),o.hasClass("is-invalid")||o.addClass("is-invalid"),c&&!e.hasClass("is-invalid")&&e.addClass("is-invalid"),e[0]===o[0]||c||e.text(l[0]))}),s(t.find(".validation-summaryinput[type=radio][id=Object_TypeShift]"),function(t,i){var r=n(i);r.removeClass("hidden").show()}),s(t.find("span[class*='validation-summary']"),function(t,r){var u=n(r),f=u.attr("name"),e=i[f];u.text(e);u.attr("style","color:rgb(255, 0, 0);");u.removeClass("hidden").show()}),f!=null){var o=t.closest(".modal").length>0,l=o?t.closest(".modal"):n("html,body"),e=f.closest(".form-group"),h=0;(o&&e.position()!==r||e.offset()!==r)&&(h=o?e.position().top+100:e.offset().top-70);h>0&&l.animate({scrollTop:h},400,function(){})}}else u.error("Validation only work on form element")}let u=t.app=t.app||{version:"1.0.0"},tt="",it="",b={},c={},yt=n.extend,s=n.each,ci=n.isArray,pt=n.proxy,rt=n.noop,y={},k={},l={},ut=function(n,t,i){confirm(n+"\n"+t)&&i.apply(this)},ft=function(n,t){alert(n+": "+t)},p={error:"error",warning:"warning",success:"success"},a={post:"POST",get:"GET",put:"PUT","delete":"DELETE"},et={json:"json",xml:"xml",html:"html",text:"text"},d={grid:"kendoGrid",listview:"kendoListView"},ot="application/json; charset=utf-8",li=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);if(u.submitForm=function(t,i){var r=f(t),e=r.attr("action"),s=(r.attr("method")||a.post).toLowerCase(),h=r.serializeObject(),u=n[s];o(u)&&u(e,h,function(n){i.apply(r[0],[n])}).fail(function(n){var t=n.responseJSON||{};vt(r,t)||r.validate(t)})},u.getHub=wt,u.localize=function(t){l=n.extend({},l,t)},u.translate=function(n){return l.hasOwnProperty(n)?l[n]:n},u.fillData=function(t,i){var r=f(t),u=r.find("[data-field]");s(u,function(t,r){var u=n(r),f=u.data("field");typeof i[f]!="undefined"&&u.text(i[f])})},u.toHierarchy=function(n,t,i,r){var f=[],u={};return n.forEach(function(n){u[n[t]]=n}),Object.keys(u).forEach(function(n){var t=u[n],e;t[i]===null?f.push(t):t[i]in u&&(e=u[t[i]],r in e||(e[r]=[]),e[r].push(t))}),f},u.refreshControl=function(n){var t,r,i;n&&(t=f(n),t.length!=0)&&(r=t.data("role"),i=t.data(d[r]).dataSource,i&&i.read())},u.formatValue=function(n,t){var i=new RegExp(t,"ig");return n.replace(i,function(n){return"<strong>"+n+"<\/strong>"})},u.set=function(n,t){b[n]=t},u.get=function(n){return b.hasOwnProperty(n)?b[n]:null},u.resolveImageUrl=function(n){var t=u.get("imageHandlerUrl")||"";return kendo.format(t,n)},u.resolveUrl=function(n){return n.replace("~",tt)},u.init=function(n){var t=n.data||{},i;if(u.set("imageHandlerUrl",n.imageHandlerUrl||""),tt=n.baseUrl,it=n.uploadUrl,l=n.localizer,v(n.hubUrl||"")||st(n.hubUrl),!e(t))for(i in t)u.set(i,t[i]);u.init=rt},u.invokeHandler=function(n,t){if(!u.hasHandler(n))throw`Handler with name '${n}' is not registered`;var i=u.getHandler(n);return i(t)},u.interceptHandler=function(n,t,i){var r=u.getHandler(n);u.registerHandler(n,function(n){var u=this;t(n)?i.apply(u,[n,function(){r.apply(u,[n])}]):r.apply(u,[n])})},u.hasHandler=function(n){return c.hasOwnProperty(n)},u.getHandler=function(n){if(!u.hasHandler(n))throw`Handler with name '${n}' is not found`;return c[n]},u.registerHandler=function(n,t){if(!o(t))throw`'${n}' is not a function`;c[n]=t},u.setAlertHandler=function(n){o(n)&&(ft=n)},u.setConfirmHandler=function(n){o(n)&&(ut=n)},u.confirm=function(n,t,i){o(t)&&(i=t,t="");ut(n,t,i)},u.warning=function(n,t){w(p.warning,n,t)},u.success=function(n,t){w(p.success,n,t)},u.error=function(n,t){w(p.error,n,t)},u.close=function(n){let t=f(n),i=t.hasClass("modal")?t:f(t.data("modal"))||t.closest(".modal");i.length>0&&i.modal("hide")},u.flash=function(n,i="flashMessage"){t.sessionStorage.setItem(i,n)},u.initJqueryEvents=function(){n("body").on("click","[data-trigger='modal'],[data-trigger='handler'],[data-trigger='submit'],a[data-trigger='filter']",function(t){let i=n(this),r=i.data("trigger");ei(r,i);t.preventDefault&&!i.is(":checkbox")&&t.preventDefault()});n("body").on("keyup","input[data-trigger='filter']",function(t){if(t.keyCode===13){let i=n(this),r=i.data("trigger");oi(i);t.preventDefault&&!i.is(":checkbox")&&t.preventDefault()}});u.initJqueryEvents=rt},n.fn.extend({upload:function(){var t=n(this)[0];si(t)}}),u.parseDate=function(n){return new Date(n.replace(/-/g,"/").replace("T"," "))},typeof Number.prototype.isBetween=="undefined"&&(Number.prototype.isBetween=function(n,t,i){var r=!1;return i?this<t&&this>n&&(r=!0):this<=t&&this>=n&&(r=!0),r}),u.clearValidation=function(n){var t=f(n);t.find("span.invalid[data-validation-for]").text("");t.find(".is-invalid").removeClass("is-invalid")},u.formatNumber=function(n){return n=parseFloat(n),n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},u.blockUI=function(t){let i="";if(t=n.extend(!0,{},t),i=t.animate?'<div class="loading-message '+(t.boxed?"loading-message-boxed":"")+'"><div class="block-spinner-bar"><div class="bounce1"><\/div><div class="bounce2"><\/div><div class="bounce3"><\/div><\/div><\/div>':t.iconOnly?'<div class="loading-message '+(t.boxed?"loading-message-boxed":"")+'"><img src="'+u.resolveUrl("~/img/loading-spinner-grey.gif")+'" align=""><\/div>':t.textOnly?'<div class="loading-message '+(t.boxed?"loading-message-boxed":"")+'"><span>&nbsp;&nbsp;'+(t.message?t.message:"LOADING...")+"<\/span><\/div>":'<div class="loading-message '+(t.boxed?"loading-message-boxed":"")+'"><img src="'+u.resolveUrl("~/img/loading-spinner-grey.gif")+'" align=""><span>&nbsp;&nbsp;'+(t.message?t.message:"LOADING...")+"<\/span><\/div>",t.target){var r=f(t.target);r.block({message:i,baseZ:t.zIndex?t.zIndex:1e3,css:{border:"0",padding:"0",backgroundColor:"none"},overlayCSS:{backgroundColor:t.overlayColor?t.overlayColor:"#555",opacity:t.boxed?.05:.1,cursor:"wait"}})}else n.blockUI({message:i,baseZ:t.zIndex?t.zIndex:1e3,css:{border:"0",padding:"0",backgroundColor:"none"},overlayCSS:{backgroundColor:t.overlayColor?t.overlayColor:"#555",opacity:t.boxed?.05:.1,cursor:"wait"}})},u.unblockUI=function(t){if(t){var i=f(t);i.unblock({onUnblock:function(){i.css("position","");i.css("zoom","")}})}else n.unblockUI()},n.fn.validate=function(n){hi(this,n)},yt(FormSerializer.patterns,{validate:/^[a-z][a-z0-9_-]*(?:\.[a-z0-9_]+)*(?:\[\])*(?:\[(?:\d*|[a-z0-9_-]+)\])*$/i,key:/[a-z0-9_-]+|(?=\[\])/gi,named:/^[a-z0-9_-]+$/i}),n.toDefault=function(n,t){return typeof n=="undefined"||n===null||n===""?t:n},n.post=function(n,t,i){return nt(a.post,n,t,i,et.json,ot)},n.put=function(n,t,i){return nt(a.put,n,t,i,et.json,ot)},n.delete=function(n,t,i){return nt(a.delete,n,t,i)},n.printWords=function(t){var i=Math.floor(t);return i<12?" "+["","satu","dua","tiga","empat","lima","enam","tujuh","delapan","sembilan","sepuluh","sebelas"][i]:i<20?n.printWords(i-10)+" belas":i<100?n.printWords(i/10)+" puluh"+n.printWords(i%10):i<200?" seratus"+n.printWords(i-100):i<1e3?n.printWords(i/100)+" ratus"+n.printWords(i%100):i<2e3?" seribu"+n.printWords(i-1e3):i<1e6?n.printWords(i/1e3)+" ribu"+n.printWords(i%1e3):i<1e9?n.printWords(i/1e6)+" juta"+n.printWords(i%1e6):i<1e12?n.printWords(i/1e9)+" milyar"+n.printWords(i%1e9):void 0},t.applicationConfiguration!==r)u.init(t.applicationConfiguration);else throw"Config must be define";u.unique=function(t){var i=[];return n.each(t,function(t,r){n.inArray(r,i)==-1&&i.push(r)}),i}})(jQuery,window,signalR);$(function(){app.initJqueryEvents()});