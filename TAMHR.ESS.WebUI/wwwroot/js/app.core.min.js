/*!
  * App Core v1.0.0
  * Copyright 2018 by Hensem Brian
  */
(function(n,t,i,r){function st(n){if(a(n))throw`Url cannot be empty`;return v=(new i.HubConnectionBuilder).withUrl(u.resolveUrl(n)).configureLogging(i.LogLevel.Information).build()}function vt(n=""){return f(v)?st(n):v}function d(t,i){let u={},f=i!==r;return t.length&&s(t[0].attributes,function(n,t){(!f||f&&t.name.startsWith(i))&&(u[t.name.substring(f?i.length:0)]=t.value)}),n.isEmptyObject(u)?r:u}function f(t){return t===r||n.isEmptyObject(t)}function a(n){return n===null||n===""}function g(t,i,r,e,o,s){return n.ajax({type:t,contentType:s,url:u.resolveUrl(i),dataType:o,data:f(o)?r:JSON.stringify(r),success:function(n){typeof e=="function"&&e(n)}})}function o(n){return typeof n=="function"}function bt(n){return typeof n=="string"}function h(n){return c.hasOwnProperty(n)?c[n]:r}function w(n,t,i){let r=i||"";ut(n,r,t)}function kt(n){return k.hasOwnProperty(n)||(k[n]=0),++k[n]}function e(t){return t===r?r:bt(t)?n("#"+t):t.jquery?t:n(t)}function dt(n){return n!==r&&e(n).length>0}function gt(t){let i=e(t),c=i.data("modal"),p=i.data("modalIcon"),l=i.data("modalTitle")||i.data("title"),k=i.data("htmlTitle")||!1,w=i.data("modalType")||"lg",g=i.data("modalAjax")||!1,b=u.resolveUrl(i.data("ajaxUrl")||""),nt=i.data("modalCallback")||"",tt=dt(c);if(f(c)&&(c="app-modal-instance-"+kt("modal"),i.data("modal",c)),!tt){let t=`
                    <div id="${c}" class="modal fade bs-modal-${w}" tabindex="-1" role="dialog" aria-hidden="true" style="display: none;">
                        <div class="modal-dialog modal-${w}" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">${l}</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="loader"></div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn dark btn-outline" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>`;n("body").append(t)}let s=e(c),v=h(nt),y=s.find(".modal-title");if(f(p)?k?y.html(l):y.text(l):y.html(`<i class="${p}"></i> `+l),g&&!a(b)){let t=s.find(".loader")||s.find(".modal-body"),u=i.data("ajaxParameters")||i.data("parameters")||d(i,"data-parameters-"),e=i.data("ajaxHandler")||"",n=u;if(f(n)){let t=h(e);n=o(t)?t.apply(i[0]):{}}t.load(b,n,function(n,t){if(t!=="error"){let i=s.find(".modal-footer");i.find(".actions").remove();let u=s.find(".modal-body .actions").detach();u.length>0&&i.prepend(u);v!==r&&v.apply(s)}})}else if(v!==r)s.on("show.bs.modal",at(v,s));s.modal("show")}function ni(n){let t=e(n),u=t.data("handler")||"",f=t.data("parameters")||d(t,"data-parameters-")||{},i=h(u);return o(i)?i.apply(t[0],[f]):r}function ti(t){n.extend(FormSerializer.patterns,{validate:/^[a-z][a-z0-9_-]*(?:\.[a-z0-9_]+)*(?:\[\])*(?:\[(?:\d*|[a-z0-9_-]+)\])*$/i,key:/[a-z0-9_-]+|(?=\[\])/gi,named:/^[a-z0-9_-]+$/i});let i=e(t.data("targetForm"))||t.closest("form"),u=t.attr("name"),o=t.val(),f=i.find("input[name='"+u+"']");return f===r||f===null||f.length===0?i.append("<input type='hidden' name='"+u+"' value ='"+o+"'>"):i.find("input[name='"+u+"']").val(o),i}function ii(n){let t=e(n),r=t.closest(".modal"),i=r.length>0?r.find("form"):ti(t),o=(i.attr("method")||p.post).toLowerCase(),s=i.serializeObject(),c=i.attr("action")||t.data("url"),y=t.data("interceptor")||"",f=t.data("precallback")||"",l=t.data("callback")||"",a=h(y),v=h(f),w=t.data("confirmation"),b=t.data("confirmationmsg");w===!0?u.confirm(b,function(u){u.value&&ht(t,r,i,o,s,c,f,l,v,n,a)}):ht(t,r,i,o,s,c,f,l,v,n,a)}function ht(t,i,e,s,c,l,a,v,y,p,w){var k=t.data("parameters")||d(t,"data-parameters-")||{},b;if(t.prop("disabled",!0),o(w)&&(c=w.apply(p,[c])),f(y)||y.apply(p)===!0){if(b=n[s],!o(b))return;b(l,c,function(n){let t=h(v);t!==r?t.apply(p,[n,k]):u.warning("Warning","Callback must be defined")}).fail(function(n){var t=n.responseJSON||{};ui(e,t)||e.validate(t)}).always(function(){t.prop("disabled",!1)})}}function ct(t,i){return f(t)?t:n.extend({},t,i||{})}function lt(t,i){if(typeof t=="undefined")return{};if(n.isPlainObject(t))return t;let r={};return r[i]=t,r}function ri(t){let r=e(t),u=r.closest("[data-role='filter']"),v=r.closest("li"),c=r.closest("ul"),o=r.data("clear")||"",h=ct(lt(r.data("sort"),"field"),{dir:"asc"}),l=ct(lt(r.data("filter"),"field"),{operator:"eq"}),i=u.data("query")||{};i.sort=f(h)?o=="sort"?{}:i.sort:h;i.filter=f(l)?o=="filter"?{}:i.filter:l;c.find("li").removeClass("active");a(o)&&v.removeClass("active").addClass("active");let y=n("[data-filter='"+u.attr("id")+"']");s(y,(t,r)=>{let e=n(r),u=e.data(et[e.data("role")]).dataSource;!f(i.sort)&&!f(u._sort)&&u._sort.length>0&&u._sort[0].field==i.sort.field&&(i.sort.dir=u._sort[0].dir=="asc"?"desc":"asc");let o=n.extend({},i,{page:u.options.page,pageSize:u.options.pageSize});u.query(o)});c.find("i.float-right").remove();f(h)||(i.sort.dir=="asc"?r.append("<i class='ft-arrow-up float-right font-red-sunglo' style='font-size: 0.76rem; margin-top: 0.25rem;'><\/i>"):r.append("<i class='ft-arrow-down float-right font-red-sunglo' style='font-size: 0.76rem; margin-top: 0.25rem;'><\/i>"));u.data("query",i)}function ui(n,t){return t.hasOwnProperty("Exception")?(n.find("[role='alert']").removeClass("hidden").show(),n.find(".alert-title").text(t.Title),n.find(".alert-message").text(t.Message),!0):!1}function fi(n,t){switch(n){case"modal":gt(t);break;case"handler":ni(t);break;case"submit":ii(t);break;case"filter":ri(t)}}function ei(t){let i=e(t),u=i.data("operator")||"or",f=i.data("filters"),o=i.closest("[data-role='filter']"),r=[],h=n("[data-filter='"+o.attr("id")+"']");s(f,function(n,t){let f=typeof t=="string"?t:t.field,e=t.operator||"contains",u=i.val();u!=""&&u!=null&&r.push({field:f,operator:e,value:u})});s(h,function(t,i){let f=n(i),e=f.data(et[f.data("role")]).dataSource;e.filter({logic:u,filters:r})})}function oi(i){var e,s;let u=i.closest("form"),o=i.files[0],f=i.name;e=new FormData;e.append(o.name,o);s=n.ajax({url:tt,type:"POST",contentType:!1,processData:!1,data:e,cache:!1,async:!0,xhr:function(){var n=new t.XMLHttpRequest;return n.upload.addEventListener("progress",function(n){if(n.lengthComputable)var t=Math.round(n.loaded/n.total*100)},!1),n}}).done(function(t){(t.files!==r||t.files!==null)&&n.each(t.files,function(t,i){i.Id!==null?(n(".common-file-"+f).remove(),n(u).append("<div class='common-file-"+f+"' data-id='"+i.Id+"' data-filename='"+i.FileName+"'>"),n(u).append("<input type='hidden' name='Attachments[][CommonFileId]' value ='"+i.Id+"'>"),n(u).append("<input type='hidden' name='Attachments[][FieldCategory]' value ='"+f+"'>"),n(u).append("<input type='hidden' name='Attachments[][FileName]' value ='"+i.FileName+"'>"),n(u).append("<\/div>")):w(y.error,"Attachment gagal di upload, mohon ulangi kembali.","Upload Failed")})}).fail(function(n,t,i){i==="abort"?alert("Uploading was aborted"):alert("Uploading failed")}).always(function(){})}function si(t,i){var r=t[0].nodeName.toLowerCase();r==="form"?(s(t.find("[data-validation-for]"),function(r,u){var f=n(u),o=f.data("validationFor"),e=t.find("[name='"+o+"']"),s=e.parent().closest(".form-control"),h;(s.removeClass("is-invalid"),e.removeClass("is-invalid"),i.hasOwnProperty(o))&&(h=i[o],s.addClass("is-invalid"),e.addClass("is-invalid"),f.css("display")!=="none"&&f[0]!==e[0]&&f.text(h))}),s(t.find(".validation-summary"),function(t,i){var r=n(i);r.removeClass("hidden").show()})):u.error("Validation only work on form element")}let u=t.app=t.app||{version:"1.0.0"},nt="",tt="",b={},c={},hi=n.extend,s=n.each,ci=n.isArray,at=n.proxy,it=n.noop,v={},k={},l={},rt=function(n,t,i){confirm(n+"\n"+t)&&i.apply(this)},ut=function(n,t){alert(n+": "+t)},y={error:"error",warning:"warning",success:"success"},p={post:"POST",get:"GET",put:"PUT","delete":"DELETE"},ft={json:"json",xml:"xml",html:"html",text:"text"},et={grid:"kendoGrid",listview:"kendoListView"},ot="application/json; charset=utf-8",li=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);if(u.getHub=vt,u.localize=function(t){l=n.extend({},l,t)},u.translate=function(n){return l.hasOwnProperty(n)?l[n]:n},u.toHierarchy=function(n,t,i,r){var f=[],u={};return n.forEach(function(n){u[n[t]]=n}),Object.keys(u).forEach(function(n){var t=u[n],e;t[i]===null?f.push(t):t[i]in u&&(e=u[t[i]],r in e||(e[r]=[]),e[r].push(t))}),f},u.formatValue=function(n,t){var i=new RegExp(t,"ig");return n.replace(i,function(n){return"<strong>"+n+"<\/strong>"})},u.set=function(n,t){b[n]=t},u.get=function(n){return b.hasOwnProperty(n)?b[n]:null},u.resolveUrl=function(n){return n.replace("~",nt)},u.init=function(n){nt=n.baseUrl;tt=n.uploadUrl;l=n.localizer;a(n.hubUrl||"")||st(n.hubUrl);u.init=it},u.invokeHandler=function(n,t){if(!u.hasHandler(n))throw`Handler with name '${n}' is not registered`;var i=u.getHandler(n);return i(t)},u.interceptHandler=function(n,t,i){var r=u.getHandler(n);u.registerHandler(n,function(n){var u=this;t(n)?i.apply(u,[n,function(){r.apply(u,[n])}]):r.apply(u,[n])})},u.hasHandler=function(n){return c.hasOwnProperty(n)},u.getHandler=function(n){if(!u.hasHandler(n))throw`Handler with name '${n}' is not found`;return c[n]},u.registerHandler=function(n,t){if(!o(t))throw`'${n}' is not a function`;c[n]=t},u.setAlertHandler=function(n){o(n)&&(ut=n)},u.setConfirmHandler=function(n){o(n)&&(rt=n)},u.confirm=function(n,t,i){o(t)&&(i=t,t="");rt(n,t,i)},u.warning=function(n,t){w(y.warning,n,t)},u.success=function(n,t){w(y.success,n,t)},u.error=function(n,t){w(y.error,n,t)},u.close=function(n){let t=e(n),i=t.hasClass("modal")?t:e(t.data("modal"))||t.closest(".modal");i.length>0&&i.modal("hide")},u.initJqueryEvents=function(){n("body").on("click","[data-trigger='modal'],[data-trigger='handler'],[data-trigger='submit'],a[data-trigger='filter']",function(t){let i=n(this),r=i.data("trigger");fi(r,i);t.preventDefault&&!i.is(":checkbox")&&t.preventDefault()});n("body").on("keyup","input[data-trigger='filter']",function(t){if(t.keyCode==13){let i=n(this),r=i.data("trigger");ei(i);t.preventDefault&&!i.is(":checkbox")&&t.preventDefault()}});u.initJqueryEvents=it},n.fn.extend({upload:function(){var t=n(this)[0];n("input[type='text'][name='"+t.name+"']").val(t.files[0].name);oi(t)}}),typeof Number.prototype.isBetween=="undefined"&&(Number.prototype.isBetween=function(n,t,i){var r=!1;return i?this<t&&this>n&&(r=!0):this<=t&&this>=n&&(r=!0),r}),u.formatNumber=function(n){return n=parseFloat(n),n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},n.fn.validate=function(n){si(this,n)},n.toDefault=function(n,t){return typeof n=="undefined"||n===null||n===""?t:n},n.post=function(n,t,i){return g(p.post,n,t,i,ft.json,ot)},n.put=function(n,t,i){return g(p.put,n,t,i,ft.json,ot)},n.delete=function(n,t,i){return g(p.delete,n,t,i)},n.printWords=function(t){var i=Math.floor(t);return i<12?" "+["","satu","dua","tiga","empat","lima","enam","tujuh","delapan","sembilan","sepuluh","sebelas"][i]:i<20?n.printWords(i-10)+" belas":i<100?n.printWords(i/10)+" puluh"+n.printWords(i%10):i<200?" seratus"+n.printWords(i-100):i<1e3?n.printWords(i/100)+" ratus"+n.printWords(i%100):i<2e3?" seribu"+n.printWords(i-1e3):i<1e6?n.printWords(i/1e3)+" ribu"+n.printWords(i%1e3):i<1e9?n.printWords(i/1e6)+" juta"+n.printWords(i%1e6):i<1e12?n.printWords(i/1e9)+" milyar"+n.printWords(i%1e9):void 0},t.applicationConfiguration!==r)u.init(t.applicationConfiguration);else throw"Config must be define";})(jQuery,window,signalR);$(function(){app.initJqueryEvents()});